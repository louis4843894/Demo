<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>社區客服系統 · 功能頁</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0a443f" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="icon" href="icons/icon-192.png" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />

  <!-- Material Web -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:FILL@0..1" rel="stylesheet" />
  <script type="module">import 'https://esm.run/@material/web/all.js';</script>

  <style>
    :root{ --container-w: min(1140px, calc(100vw - 24px)); }
    html,body{height:100%}
    body{margin:0;font-family: Roboto, system-ui, -apple-system, "Segoe UI", Arial;}
    md-top-app-bar{ position: sticky; top: 0; z-index: 110; }
    .container{width:var(--container-w);margin-inline:auto}
    .muted{opacity:.66}
  </style>
</head>
<body>
  <md-top-app-bar>
    <md-icon-button slot="navigationIcon" aria-label="首頁" title="首頁" onclick="location.href='index.html'">
      <span class="material-symbols-outlined">home</span>
    </md-icon-button>
    <div slot="headline" style="font-weight:900;letter-spacing:.4px">社區客服 · 功能頁</div>

    <md-menu id="userMenu" anchor="userBtn">
      <md-menu-item disabled>
        <div slot="headline" id="authName">使用者</div>
        <div slot="supporting-text" id="authMail" class="muted">user@example.com</div>
      </md-menu-item>
      <md-divider></md-divider>
      <md-menu-item onclick="logout()">
        <span slot="start" class="material-symbols-outlined">logout</span>
        <div slot="headline">登出</div>
      </md-menu-item>
    </md-menu>
    <md-icon-button id="userBtn" slot="actionItems" aria-label="帳號" title="帳號" onclick="userMenu.show()">
      <span class="material-symbols-outlined">account_circle</span>
    </md-icon-button>
  </md-top-app-bar>

  <main class="container" style="padding:22px 0 28px">
    <h2 id="tabTitle" style="font-weight:900;letter-spacing:.3px;margin:0 0 12px"></h2>
    <div class="muted" style="margin-bottom:16px">此頁需登入一般帳號即可存取。</div>

    <div id="content">
      <!-- 這裡可依 hash 顯示不同模組內容；先放簡單範例 -->
      <div id="announcement" hidden>公告/投票內容…</div>
      <div id="maintenance" hidden>維修/客服內容…</div>
      <div id="finance" hidden>帳務/收費內容…</div>
      <div id="resident" hidden>住戶/人員內容…</div>
      <div id="visitor" hidden>訪客/包裹內容…</div>
      <div id="meeting" hidden>會議/活動內容…</div>
    </div>
  </main>

  <!-- 安裝 App FAB -->
  <md-fab id="installCta" label="安裝 App" variant="secondary">
    <span class="material-symbols-outlined" slot="icon">download</span>
  </md-fab>

  <script src="index.js"></script>
  <script>
    ensureLogin();        // 未登入則導去 auth.html?next=app.html#...
    initPage('app');      // 更新使用者顯示、PWA 安裝
    showSectionFromHash(); // 顯示對應模組
    window.addEventListener('hashchange', showSectionFromHash);

    function showSectionFromHash(){
      const id = (location.hash||'#announcement').slice(1);
      document.querySelectorAll('#content > div').forEach(d=>d.hidden=true);
      const el = document.getElementById(id);
      if(el) el.hidden = false;
      document.getElementById('tabTitle').textContent = ({
        announcement:'公告 / 投票',
        maintenance:'維修 / 客服',
        finance:'帳務 / 收費',
        resident:'住戶 / 人員',
        visitor:'訪客 / 包裹',
        meeting:'會議 / 活動'
      }[id] || '功能');
    }
  </script>
</body>
</html>
